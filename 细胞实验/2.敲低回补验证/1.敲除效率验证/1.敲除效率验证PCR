library(ggplot2)
library(ggpubr)

# --- 数据准备 ---
data_qpcr_kd <- data.frame(
  Group = rep(c("Mock", "NC", "CRISPRi-1", "CRISPRi-2", "CRISPRi-3"), each = 3),
  Value = c(1.074, 1.089, 0.854, 
            1.045, 1.016, 1.259, 
            0.317, 0.315, 0.333, 
            0.210, 0.203, 0.202, 
            0.103, 0.089, 0.094)
)
data_qpcr_kd$Group <- factor(data_qpcr_kd$Group, levels = c("Mock", "NC", "CRISPRi-1", "CRISPRi-2", "CRISPRi-3"))

# --- 配色 ---
color_palette_sop <- c("#666666", "black", "#a30001", "#a30001", "#a30001")
shape_palette_sop <- c(16, 16, 15, 15, 15)

# --- 绘图 ---
p_qpcr_kd <- ggplot(data_qpcr_kd, aes(x = Group, y = Value, color = Group, shape = Group)) +
  geom_bar(stat = "summary", fun = "mean", fill = "white", linewidth = 0.8, width = 0.5) +
  geom_errorbar(stat = "summary", fun.data = "mean_sd", width = 0.2, linewidth = 0.8, position = position_dodge(0.6)) +
  geom_jitter(width = 0.1, size = 2.5, alpha = 1) +
  
  stat_compare_means(method = "t.test", ref.group = "NC", label = "p.signif", 
                     label.y = c(1.3, 1.3, 1.2, 1.2, 1.2), hide.ns = TRUE, color = "black", size = 5) +
  
  scale_color_manual(values = color_palette_sop) +
  scale_shape_manual(values = shape_palette_sop) +
  labs(x = NULL, y = "Relative mRNA Expression") +
  
  theme_classic() +
  theme(
    axis.text.x = element_text(size = 12, color = "black", angle = 45, hjust = 1, face = "bold"),
    axis.text.y = element_text(size = 12, color = "black", face = "bold"),
    axis.title.y = element_text(size = 14, face = "bold", color = "black"),
    axis.ticks = element_line(color = "black", linewidth = 0.8), axis.ticks.length = unit(0.15, "cm"),
    axis.line = element_line(color = "black", linewidth = 0.8),
    panel.border = element_blank(), legend.position = "none", plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm")
  ) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 1.5))

ggsave("Fig2_qPCR_Knockdown.pdf", p_qpcr_kd, width = 3.5, height = 4)