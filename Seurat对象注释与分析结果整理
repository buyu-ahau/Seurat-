é‡æ–°æ³¨é‡Šç»“æœæ€»ç»“
ğŸ“Š æ³¨é‡Šç»Ÿè®¡ç»“æœ
åŸºæœ¬ä¿¡æ¯:

æ€»ç»†èƒæ•°: 35,330
æ€»åŸºå› æ•°: 33,029
åŸå§‹clusteræ•°: 20 (0-19)
æœ€ç»ˆç»†èƒç±»å‹æ•°: 12
ğŸ§¬ ç»†èƒç±»å‹åˆ†å¸ƒè¯¦æƒ…
ç»†èƒç±»å‹	ç»†èƒæ•°é‡	ç™¾åˆ†æ¯”
CD8_cells	9,450	26.75%
Plasma_cells	8,141	23.04%
Macrophages	6,054	17.14%
Neutrophils	3,359	9.51%
B_cells	2,226	6.30%
CD4_cells	1,838	5.20%
Fibroblasts	1,043	2.95%
Endothelial_cells	862	2.44%
DC_cells	832	2.35%
NK_cells	747	2.11%
Epithelial_cells	624	1.77%
Unknown_cells	154	0.44%
ğŸ—‚ï¸ Clusteråˆ°ç»†èƒç±»å‹æ˜ å°„
Code
Cluster 0 â†’ CD8_cells (6,788 cells)
Cluster 1 â†’ Plasma_cells (4,217 cells)
Cluster 2 â†’ Plasma_cells (3,924 cells)
Cluster 3 â†’ Neutrophils (3,359 cells)
Cluster 4 â†’ Macrophages (3,212 cells)
Cluster 5 â†’ Macrophages (2,842 cells)
Cluster 6 â†’ CD8_cells (2,662 cells)
Cluster 7 â†’ B_cells (2,065 cells)
Cluster 8 â†’ CD4_cells (1,838 cells)
Cluster 9 â†’ Fibroblasts (1,043 cells)
Cluster 10 â†’ DC_cells (832 cells)
Cluster 11 â†’ NK_cells (627 cells)
Cluster 12 â†’ Endothelial_cells (575 cells)
Cluster 13 â†’ Epithelial_cells (498 cells)
Cluster 14 â†’ Endothelial_cells (287 cells)
Cluster 15 â†’ B_cells (161 cells)
Cluster 16 â†’ Epithelial_cells (126 cells)
Cluster 17 â†’ NK_cells (120 cells)
Cluster 18 â†’ Unknown_cells (88 cells)
Cluster 19 â†’ Unknown_cells (66 cells)
ğŸ“ ç”Ÿæˆæ–‡ä»¶
æ•°æ®æ–‡ä»¶:

object_reannotated_final_celltype.qs - é‡æ–°æ³¨é‡Šçš„Seuratå¯¹è±¡
object_reannotated_final_celltype.rds - å¤‡ä»½æ ¼å¼
cluster_to_celltype_mapping.csv - æ˜ å°„å…³ç³»è¡¨
å¯è§†åŒ–æ–‡ä»¶:

celltype_distribution.png - ç»†èƒç±»å‹åˆ†å¸ƒå›¾
umap_by_clusters.png - æŒ‰clusterç€è‰²çš„UMAPå›¾
umap_by_final_celltype.png - æŒ‰ç»†èƒç±»å‹ç€è‰²çš„UMAPå›¾
umap_comparison.png - UMAPå¯¹æ¯”å›¾
cluster_celltype_heatmap.png - äº¤å‰è¡¨çƒ­å›¾


Seuratå¯¹è±¡æ³¨é‡Šä¸åˆ†æç»“æœæ•´ç†

æœ¬æ–‡ä»¶æ•´ç†äº†`object_annotated_gene_symbols.qs`çš„Seuratå¯¹è±¡åŸºæœ¬ä¿¡æ¯ã€å…ƒæ•°æ®å­—æ®µï¼Œä»¥åŠclusterä¸celltypeæ³¨é‡Šå…³ç³»çš„ç”Ÿæˆè„šæœ¬å’Œå¯¹åº”ç»“æœã€‚ä¾¿äºåç»­åˆ†æä¸æŸ¥é˜…ã€‚

---

## Seuratå¯¹è±¡ä¿¡æ¯

- ç‰¹å¾æ•°ï¼ˆåŸºå› æ•°ï¼‰ï¼š33,029
- ç»†èƒæ•°ï¼š35,330
- æ¿€æ´»Assayï¼šRNA
- è®¡ç®—çš„é™ç»´ï¼špca, pca_RNA, harmony_RNA, tsne, tsne_harmony_RNA, umap, umap_harmony_RNA, tsne3, tsne3_harmony_RNA, umap3, umap3_harmony_RNA

---

## å…ƒæ•°æ®ä¸»è¦å­—æ®µè¯´æ˜

| å­—æ®µåç§°              | å«ä¹‰                |
|----------------------|---------------------|
| orig.ident           | åŸå§‹æ ·æœ¬ç¼–å·        |
| nCount_RNA           | æ¯ä¸ªç»†èƒçš„RNAè®¡æ•°   |
| nFeature_RNA         | æ¯ä¸ªç»†èƒçš„ç‰¹å¾æ•°   |
| Groups / group       | åˆ†ç»„ä¿¡æ¯            |
| percent.mito         | çº¿ç²’ä½“åŸºå› æ¯”ä¾‹      |
| percent.hgb          | è¡€çº¢è›‹ç™½åŸºå› æ¯”ä¾‹    |
| S.Score, G2M.Score   | ç»†èƒå‘¨æœŸåˆ†æ•°        |
| Phase                | ç»†èƒå‘¨æœŸé˜¶æ®µ        |
| CC.Difference        | ç»†èƒå‘¨æœŸåˆ†æ•°å·®      |
| RNA_snn_res.0.5      | SNNèšç±»åˆ†è¾¨ç‡       |
| seurat_clusters      | Seuratèšç±»ç¼–å·      |
| celltype             | ç»†èƒç±»å‹æ³¨é‡Š        |

---

## Rè„šæœ¬ï¼šç”Ÿæˆclusterä¸celltypeå¯¹åº”å…³ç³»è¡¨

```r
# åŠ è½½å¿…è¦çš„åŒ…
library(qs)
library(Seurat)
library(dplyr)

# å®šä¹‰æ–‡ä»¶è·¯å¾„
file_path <- "/disk192/users_dir/buyu/2025-7-7é‡æ–°æ³¨é‡Šç»“æœ/object_annotated_gene_symbols.qs"

# è¯»å–qsæ–‡ä»¶
sc_object <- qread(file_path)

# æŸ¥çœ‹Seuratå¯¹è±¡åŸºæœ¬ä¿¡æ¯
print(sc_object)

# æŸ¥çœ‹å…ƒæ•°æ®å­—æ®µ
head(sc_object@meta.data)

# æŸ¥çœ‹å½“å‰çš„clusteræ°´å¹³
levels(Idents(sc_object))
table(Idents(sc_object))

# ç”Ÿæˆclusterä¸celltypeçš„å¯¹åº”å…³ç³»è¡¨
annotation_table <- table(sc_object$seurat_clusters, sc_object$celltype)

# æ‰“å°è¡¨æ ¼
print(annotation_table)

# å¯é€‰ï¼šä¿å­˜ä¸ºcsv
write.csv(annotation_table, file = "cluster_celltype_crosstab.csv")
```

---

## ç»“æœç¤ºä¾‹ï¼ˆannotation_tableï¼‰

```text
           B_cell DC_cell Endothelial_cell Epithelial_cell Fibroblast Macrophage Neutrophil NK-T_cell Plasma_cell
  0             0       0                0               0          0          0          0      6788           0
  1          4217       0                0               0          0          0          0         0           0
  2          3924       0                0               0          0          0          0         0           0
  3             0       0                0               0          0          0       3359         0           0
  4             0       0                0               0          0       3212          0         0           0
  5             0       0                0               0          0       2842          0         0           0
  6             0       0                0               0          0          0          0      2662           0
  7             0       0                0               0          0          0          0         0        2065
  8             0       0                0               0          0          0          0      1838           0
  9             0       0                0               0       1043          0          0         0           0
  10            0       0                0               0          0        832          0         0           0
  11            0       0                0               0          0          0          0       627           0
  12            0       0              575               0          0          0          0         0           0
  13            0       0                0             498          0          0          0         0           0
  14            0     287                0               0          0          0          0         0           0
  15            0       0                0               0          0          0          0         0         161
  16            0       0                0             126          0          0          0         0           0
  17            0       0                0               0          0          0          0         0         120
  18            0       0                0               0         88          0          0         0           0
  19            0       0                0               0         66          0          0         0           0
```

> å¯æ ¹æ®éœ€è¦ç›´æ¥ç”¨ä¸Šè¿°Rè„šæœ¬è¿è¡Œï¼Œæˆ–ä½¿ç”¨csvæ–‡ä»¶è¿›è¡Œä¸‹æ¸¸åˆ†æã€‚
