重新注释结果总结
📊 注释统计结果
基本信息:

总细胞数: 35,330
总基因数: 33,029
原始cluster数: 20 (0-19)
最终细胞类型数: 12
🧬 细胞类型分布详情
细胞类型	细胞数量	百分比
CD8_cells	9,450	26.75%
Plasma_cells	8,141	23.04%
Macrophages	6,054	17.14%
Neutrophils	3,359	9.51%
B_cells	2,226	6.30%
CD4_cells	1,838	5.20%
Fibroblasts	1,043	2.95%
Endothelial_cells	862	2.44%
DC_cells	832	2.35%
NK_cells	747	2.11%
Epithelial_cells	624	1.77%
Unknown_cells	154	0.44%
🗂️ Cluster到细胞类型映射
Code
Cluster 0 → CD8_cells (6,788 cells)
Cluster 1 → Plasma_cells (4,217 cells)
Cluster 2 → Plasma_cells (3,924 cells)
Cluster 3 → Neutrophils (3,359 cells)
Cluster 4 → Macrophages (3,212 cells)
Cluster 5 → Macrophages (2,842 cells)
Cluster 6 → CD8_cells (2,662 cells)
Cluster 7 → B_cells (2,065 cells)
Cluster 8 → CD4_cells (1,838 cells)
Cluster 9 → Fibroblasts (1,043 cells)
Cluster 10 → DC_cells (832 cells)
Cluster 11 → NK_cells (627 cells)
Cluster 12 → Endothelial_cells (575 cells)
Cluster 13 → Epithelial_cells (498 cells)
Cluster 14 → Endothelial_cells (287 cells)
Cluster 15 → B_cells (161 cells)
Cluster 16 → Epithelial_cells (126 cells)
Cluster 17 → NK_cells (120 cells)
Cluster 18 → Unknown_cells (88 cells)
Cluster 19 → Unknown_cells (66 cells)
📁 生成文件
数据文件:

object_reannotated_final_celltype.qs - 重新注释的Seurat对象
object_reannotated_final_celltype.rds - 备份格式
cluster_to_celltype_mapping.csv - 映射关系表
可视化文件:

celltype_distribution.png - 细胞类型分布图
umap_by_clusters.png - 按cluster着色的UMAP图
umap_by_final_celltype.png - 按细胞类型着色的UMAP图
umap_comparison.png - UMAP对比图
cluster_celltype_heatmap.png - 交叉表热图


Seurat对象注释与分析结果整理

本文件整理了`object_annotated_gene_symbols.qs`的Seurat对象基本信息、元数据字段，以及cluster与celltype注释关系的生成脚本和对应结果。便于后续分析与查阅。

---

## Seurat对象信息

- 特征数（基因数）：33,029
- 细胞数：35,330
- 激活Assay：RNA
- 计算的降维：pca, pca_RNA, harmony_RNA, tsne, tsne_harmony_RNA, umap, umap_harmony_RNA, tsne3, tsne3_harmony_RNA, umap3, umap3_harmony_RNA

---

## 元数据主要字段说明

| 字段名称              | 含义                |
|----------------------|---------------------|
| orig.ident           | 原始样本编号        |
| nCount_RNA           | 每个细胞的RNA计数   |
| nFeature_RNA         | 每个细胞的特征数   |
| Groups / group       | 分组信息            |
| percent.mito         | 线粒体基因比例      |
| percent.hgb          | 血红蛋白基因比例    |
| S.Score, G2M.Score   | 细胞周期分数        |
| Phase                | 细胞周期阶段        |
| CC.Difference        | 细胞周期分数差      |
| RNA_snn_res.0.5      | SNN聚类分辨率       |
| seurat_clusters      | Seurat聚类编号      |
| celltype             | 细胞类型注释        |

---

## R脚本：生成cluster与celltype对应关系表

```r
# 加载必要的包
library(qs)
library(Seurat)
library(dplyr)

# 定义文件路径
file_path <- "/disk192/users_dir/buyu/2025-7-7重新注释结果/object_annotated_gene_symbols.qs"

# 读取qs文件
sc_object <- qread(file_path)

# 查看Seurat对象基本信息
print(sc_object)

# 查看元数据字段
head(sc_object@meta.data)

# 查看当前的cluster水平
levels(Idents(sc_object))
table(Idents(sc_object))

# 生成cluster与celltype的对应关系表
annotation_table <- table(sc_object$seurat_clusters, sc_object$celltype)

# 打印表格
print(annotation_table)

# 可选：保存为csv
write.csv(annotation_table, file = "cluster_celltype_crosstab.csv")
```

---

## 结果示例（annotation_table）

```text
           B_cell DC_cell Endothelial_cell Epithelial_cell Fibroblast Macrophage Neutrophil NK-T_cell Plasma_cell
  0             0       0                0               0          0          0          0      6788           0
  1          4217       0                0               0          0          0          0         0           0
  2          3924       0                0               0          0          0          0         0           0
  3             0       0                0               0          0          0       3359         0           0
  4             0       0                0               0          0       3212          0         0           0
  5             0       0                0               0          0       2842          0         0           0
  6             0       0                0               0          0          0          0      2662           0
  7             0       0                0               0          0          0          0         0        2065
  8             0       0                0               0          0          0          0      1838           0
  9             0       0                0               0       1043          0          0         0           0
  10            0       0                0               0          0        832          0         0           0
  11            0       0                0               0          0          0          0       627           0
  12            0       0              575               0          0          0          0         0           0
  13            0       0                0             498          0          0          0         0           0
  14            0     287                0               0          0          0          0         0           0
  15            0       0                0               0          0          0          0         0         161
  16            0       0                0             126          0          0          0         0           0
  17            0       0                0               0          0          0          0         0         120
  18            0       0                0               0         88          0          0         0           0
  19            0       0                0               0         66          0          0         0           0
```

> 可根据需要直接用上述R脚本运行，或使用csv文件进行下游分析。
